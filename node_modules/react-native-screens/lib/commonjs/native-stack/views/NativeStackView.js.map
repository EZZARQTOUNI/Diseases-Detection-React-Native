{"version":3,"sources":["NativeStackView.tsx"],"names":["Screen","ScreenComponent","isAndroid","Platform","OS","didWarn","Container","View","__DEV__","DebugContainer","props","stackPresentation","rest","maybeRenderNestedStack","options","route","renderScene","isHeaderInModal","viewStyles","styles","container","StyleSheet","absoluteFill","NativeStackView","state","navigation","descriptors","key","routes","colors","map","index","render","contentStyle","gestureEnabled","headerShown","replaceAnimation","stackAnimation","backgroundColor","background","undefined","console","warn","isHeaderInPush","emit","type","data","closing","target","dispatch","StackActions","pop","source","create","flex"],"mappings":"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","sourcesContent":["import {\n  ParamListBase,\n  StackActions,\n  StackNavigationState,\n  useTheme,\n  Route,\n} from '@react-navigation/native';\nimport * as React from 'react';\nimport {\n  Platform,\n  StyleProp,\n  StyleSheet,\n  View,\n  ViewProps,\n  ViewStyle,\n} from 'react-native';\n// @ts-ignore Getting private component\nimport AppContainer from 'react-native/Libraries/ReactNative/AppContainer';\nimport {\n  Screen as ScreenComponent,\n  ScreenProps,\n  ScreenStack,\n  StackPresentationTypes,\n} from 'react-native-screens';\nimport {\n  NativeStackDescriptorMap,\n  NativeStackNavigationHelpers,\n  NativeStackNavigationOptions,\n} from '../types';\nimport HeaderConfig from './HeaderConfig';\n\nconst Screen = (ScreenComponent as unknown) as React.ComponentType<ScreenProps>;\nconst isAndroid = Platform.OS === 'android';\n\nlet didWarn = isAndroid;\n\nlet Container = View;\n\nif (__DEV__) {\n  const DebugContainer = (\n    props: ViewProps & { stackPresentation: StackPresentationTypes }\n  ) => {\n    const { stackPresentation, ...rest } = props;\n    if (Platform.OS === 'ios' && stackPresentation !== 'push') {\n      return (\n        <AppContainer>\n          <View {...rest} />\n        </AppContainer>\n      );\n    }\n    return <View {...rest} />;\n  };\n  // @ts-ignore Wrong props\n  Container = DebugContainer;\n}\n\nconst maybeRenderNestedStack = (\n  options: NativeStackNavigationOptions,\n  route: Route<string>,\n  renderScene: () => JSX.Element,\n  stackPresentation: StackPresentationTypes,\n  isHeaderInModal: boolean,\n  viewStyles: StyleProp<ViewStyle>\n): JSX.Element => {\n  if (isHeaderInModal) {\n    return (\n      <ScreenStack style={styles.container}>\n        <Screen enabled style={StyleSheet.absoluteFill}>\n          <HeaderConfig {...options} route={route} />\n          <Container\n            style={viewStyles}\n            // @ts-ignore Wrong props passed to View\n            stackPresentation={stackPresentation}>\n            {renderScene()}\n          </Container>\n        </Screen>\n      </ScreenStack>\n    );\n  }\n  return (\n    <Container\n      style={viewStyles}\n      // @ts-ignore Wrong props passed to View\n      stackPresentation={stackPresentation}>\n      {renderScene()}\n    </Container>\n  );\n};\n\ntype Props = {\n  state: StackNavigationState<ParamListBase>;\n  navigation: NativeStackNavigationHelpers;\n  descriptors: NativeStackDescriptorMap;\n};\n\nexport default function NativeStackView({\n  state,\n  navigation,\n  descriptors,\n}: Props): JSX.Element {\n  const { key, routes } = state;\n  const { colors } = useTheme();\n\n  return (\n    <ScreenStack style={styles.container}>\n      {routes.map((route, index) => {\n        const { options, render: renderScene } = descriptors[route.key];\n        const {\n          contentStyle,\n          gestureEnabled,\n          headerShown,\n          replaceAnimation = 'pop',\n          stackAnimation,\n        } = options;\n\n        let { stackPresentation = 'push' } = options;\n\n        if (index === 0) {\n          // first screen should always be treated as `push`, it resolves problems with no header animation\n          // for navigator with first screen as `modal` and the next as `push`\n          stackPresentation = 'push';\n        }\n\n        const viewStyles = [\n          styles.container,\n          stackPresentation !== 'transparentModal' &&\n            stackPresentation !== 'containedTransparentModal' && {\n              backgroundColor: colors.background,\n            },\n          contentStyle,\n        ];\n\n        if (\n          !didWarn &&\n          stackPresentation !== 'push' &&\n          headerShown !== undefined\n        ) {\n          didWarn = true;\n          console.warn(\n            'Be aware that changing the visibility of header in modal on iOS will result in resetting the state of the screen.'\n          );\n        }\n\n        const isHeaderInModal = isAndroid\n          ? false\n          : stackPresentation !== 'push' && headerShown === true;\n        const isHeaderInPush = isAndroid\n          ? headerShown\n          : stackPresentation === 'push' && headerShown !== false;\n\n        return (\n          <Screen\n            key={route.key}\n            enabled\n            style={StyleSheet.absoluteFill}\n            gestureEnabled={isAndroid ? false : gestureEnabled}\n            replaceAnimation={replaceAnimation}\n            stackPresentation={stackPresentation}\n            stackAnimation={stackAnimation}\n            onWillAppear={() => {\n              navigation.emit({\n                type: 'transitionStart',\n                data: { closing: false },\n                target: route.key,\n              });\n            }}\n            onWillDisappear={() => {\n              navigation.emit({\n                type: 'transitionStart',\n                data: { closing: true },\n                target: route.key,\n              });\n            }}\n            onAppear={() => {\n              navigation.emit({\n                type: 'appear',\n                target: route.key,\n              });\n              navigation.emit({\n                type: 'transitionEnd',\n                data: { closing: false },\n                target: route.key,\n              });\n            }}\n            onDisappear={() => {\n              navigation.emit({\n                type: 'transitionEnd',\n                data: { closing: true },\n                target: route.key,\n              });\n            }}\n            onDismissed={() => {\n              navigation.emit({\n                type: 'dismiss',\n                target: route.key,\n              });\n\n              navigation.dispatch({\n                ...StackActions.pop(),\n                source: route.key,\n                target: key,\n              });\n            }}>\n            <HeaderConfig\n              {...options}\n              route={route}\n              headerShown={isHeaderInPush}\n            />\n            {maybeRenderNestedStack(\n              options,\n              route,\n              renderScene,\n              stackPresentation,\n              isHeaderInModal,\n              viewStyles\n            )}\n          </Screen>\n        );\n      })}\n    </ScreenStack>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n});\n"]}